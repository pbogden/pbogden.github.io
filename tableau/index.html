<!DOCTYPE html>
<meta charset="utf-8">
<title>My D3 demo</title>
<style>

.chart div {
  font: 10px sans-serif;
  background-color: steelblue;
  text-align: right;
  padding: 3px;
  margin: 1px;
  color: white;
}

body {
  margin: 0 0;
  overflow-y: hidden; // hide vertical
  overflow-x: hidden; // hide horizontal
}

</style>
<body>
<script src="d3.v5.min.js"></script>
<script src="topojson-client.min.js"></script>
<script>

const width = window.innerWidth;
const margin = {top: 20, right: 0, bottom: 30, left: 40};
const height = window.innerHeight;

Promise.all([
    d3.json("us-10m.json"),
    d3.json("states.json")
]).then(plotit)
.catch(function(err) {
    console.log('error reading data', err)
})

function plotit(files) {

  const us = files[0];
  const json = files[1];
  console.log("Here's the data:", us, json)

  const svg = d3.select('body').append("svg")
      .style("width", "100%")
      .style("height", "auto")
      .attr("viewBox", [0, 0, 960, 600]);

  const projection = d3.geoAlbers().scale(1280).translate([480, 300])
  const path = d3.geoPath(projection);
  const scale = width / 960;

  svg.append("g")
    .selectAll("path")
    .data(topojson.feature(us, us.objects.states).features)
    .join("path")
      .classed('interior', true)
      .attr("fill", "darkgray")
      .attr("d", path)
      .on('mouseover', function(d) { 
        d3.select(this).style("fill", "red");
        let state = d.properties.STATE; 
        console.log([state, json[state]]);
      })
      .on('mouseout', function() { d3.select(this).style("fill", null) })

  svg.append("path")
      .datum(topojson.mesh(us, us.objects.states, (a, b) => a !== b))
      .classed('mesh', true)
      .attr("fill", "none")
      .attr("stroke", "white")
      .attr("stroke-linejoin", "round")
      .attr("d", path);
  
  svg.append("path")
      .datum(topojson.mesh(us, us.objects.nation))
      .classed('nation', true)
      .attr("fill", "none")
      .attr("stroke", "black")
      .attr("stroke-linejoin", "round")
      .attr("d", path);
}

</script>
