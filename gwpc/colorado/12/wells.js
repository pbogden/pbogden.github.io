d3.wells=function(){function a(u){function p(e,a,p,d){t=p;var v=a.objects.co,m=topojson.merge(a,v.geometries),g=Object.keys(d.objects).map(function(e){return topojson.feature(d,d.objects[e])}),y=o.bounds(m),b=.95/Math.max((y[1][0]-y[0][0])/n,(y[1][1]-y[0][1])/r),w=[(n-b*(y[1][0]+y[0][0]))/2,(r-b*(y[1][1]+y[0][1]))/2];s.scale(b).translate(w);var E=i.append("g");E.append("path").datum(m).attr("class","state").attr("d",o),E.append("defs").append("clipPath").attr("id","state-clip").append("path").datum(m).attr("d",o),E.append("path").datum(topojson.mesh(a,v,function(e,t){return e!==t})).attr("class","county-border").attr("d",o),E.selectAll(".basin").data(g[0].features).enter().append("path").attr("class","basin").attr("clip-path","url(#state-clip)").attr("d",o).on("mouseover",f).on("mousemove",c).on("mouseout",h),E.selectAll(".play").data(g[1].features).enter().append("path").attr("class","play").classed("prospective",function(e){return e.properties.Current==="N"}).attr("clip-path","url(#state-clip)").attr("d",o).on("mouseover",l).on("mousemove",c).on("mouseout",h),u()}return arguments.length||(u=function(){console.log("Done initializing d3.wells")}),d3.select("#wells").node()!==null?a:(n=e[0],r=e[1],i=d3.select("body").append("svg").attr("width",n).attr("height",r),queue().defer(d3.json,"co.json").defer(d3.json,"data.json").defer(d3.json,"shalegasplay.json").await(p),a)}function f(e){u[0][0].innerHTML=e.properties.NAME+" Basin",u.style("visibility","visible"),u.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function l(e){var t=e.properties.Shale_Play+" Play";e.properties.Current==="Y"&&(t+=" (current)"),e.properties.Current==="N"&&(t+=" (prospective)"),u[0][0].innerHTML=t,u.style("visibility","visible"),u.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function c(e){u.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function h(e){u.style("visibility","hidden")}var e=[600,500],t,n,r,i,s=d3.geo.albers().scale(1).translate([0,0]),o=d3.geo.path().pointRadius(2).projection(s),u=d3.select("body").append("div").attr("class","tooltip").style("visibility","hidden");return a.plotFormation=function(e,s){values=t.map(function(e){return{location:{type:"Point",coordinates:[+e.long,+e.lat]}}}),console.log("data[0]",t[0]);var u=i.selectAll(".formationLabel").data([d3.format(",.0f")(values.length)+" wells"]);u.enter().append("text").attr("class","formationLabel").attr("x",.75*n).attr("y",.1*r).style("font-size","20px").text(String),u.text(String);var f=i.selectAll("path.circle").data(values.map(function(e){return e.location}));return f.exit().remove(),f.attr("d",o),f.enter().append("path").attr("class","circle").style("fill","steelblue").style("stroke","black").style("stroke-width",.5).attr("d",o),a},a.size=function(t){return arguments.length?(e=t,a):e},a.data=function(e){return arguments.length?(t=e,a):t},a}