d3.histogram=function(){function l(){a=d3.select("body").append("div").attr("id","histogram"),f=d3.scale.linear().domain(d3.extent(r)).range([0,s]).nice();var e=d3.layout.histogram().bins(f.ticks(t))(r),c=d3.svg.axis().scale(f).ticks(n).orient("bottom"),h=d3.scale.linear().domain([0,d3.max(e,function(e){return e.y})]).range([o,0]),p=a.append("svg").attr("width",s+i.left+i.right).attr("height",o+i.top+i.bottom).append("g").attr("transform","translate ("+i.left+", "+i.top+")"),d=p.selectAll(".bar").data(e).enter().append("g").attr("class","bar").attr("transform",function(e){return"translate("+f(e.x)+", "+h(e.y)+")"});return d.append("rect").attr("x",function(e){return 0}).attr("width",function(e){return f(e.dx)-f(0)}).attr("height",function(e){return o-h(e.y)}),d.append("text").attr("dy","-.5em").attr("dx",function(e){return(f(e.dx)-f(0))/2}).attr("text-anchor","middle").style("font","14px sans-serif").style("fill","#333").style("stroke","#333").text(function(e){return e.y!=0?u(e.y):null}),p.append("g").attr("class","x axis").style("font","14px sans-serif").attr("transform","translate (0,"+o+")").call(c),l}var e=[600,500],t=10,n=5,r=d3.range(1e3).map(function(){return d3.random.normal()()}),i={top:50,right:30,bottom:30,left:30},s=e[0]-i.right-i.left,o=e[1]-i.top-i.bottom,u=d3.format(",.0f"),a,f;return l.verticals=function(e){var t=a.select("svg g");return t.selectAll(".vertical").remove(),t.selectAll("circle.vertical").data(e).enter().append("circle").attr("class","vertical").attr("cx",function(e){return f(e)}).attr("cy",0).attr("r",5).style("fill","red").style("fill-opacity",1).style("stroke-width",1).style("stroke","black"),t.selectAll("line.vertical").data(e).enter().append("line").attr("class","vertical").attr("x1",function(e){return f(e)}).attr("x2",function(e){return f(e)}).attr("y1",2.5).attr("y2",o).attr("stroke","black").attr("stroke-width",1),l},l.clear=function(){return d3.select("#histogram svg").remove(),l},l.size=function(t){return arguments.length?(e=t,l):e},l.data=function(e){return arguments.length?(r=e,l):r},l.nbins=function(e){return arguments.length?(t=e,l):t},l.ticks=function(e){return arguments.length?(n=e,l):n},l}