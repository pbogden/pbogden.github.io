d3.colorado=function(){function c(){return d3.select("#colorado").node()!==null?c:(s=d3.select("body").append("div").attr("id","colorado"),r=e[0],i=e[1],o=s.append("svg").attr("width",r).attr("height",i).style("stroke-width",1).on("click",function(){console.log("svg clicked")}),u=d3.behavior.zoom().scaleExtent([1,10]).on("zoom",p),o.call(u).call(u.event),o=o.append("g"),f.scale(1).translate([0,0]),d3.json("co.json",function(e,t){var n=t.objects.co,s=topojson.merge(t,n.geometries),u=l.bounds(s),a=.95/Math.max((u[1][0]-u[0][0])/r,(u[1][1]-u[0][1])/i),c=[(r-a*(u[1][0]+u[0][0]))/2,(i-a*(u[1][1]+u[0][1]))/2];a=12490,c=[1783,541],f.scale(a).translate(c),o.append("path").datum(s).attr("class","state").attr("d",l),o.append("path").datum(topojson.mesh(t,n,function(e,t){return e!==t})).attr("class","county-border").attr("d",l)}),c)}function h(e,t){return typeof e=="undefined"&&console.log("bad polygon for i = ",t,e),typeof e!="undefined"?"M"+e.join("L")+"Z":null}function p(){console.log("zoomed"),o.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),o.style("stroke-width",1/d3.event.scale+"px"),o.selectAll("circle").attr("r",3/d3.event.scale)}var e=[600,500],t,n=d3.format(",.0f"),r,i,s,o,u,a,f=d3.geo.albers(),l=d3.geo.path().pointRadius(2).projection(f);return c.clear=function(){return d3.select("#colorado").remove(),c},c.plotem=function(){return o.selectAll("path.circle").remove(),o.selectAll("path.circle").data(t.map(function(e){return e.location})).enter().append("path").attr("class","circle").style("fill","steelblue").style("stroke","black").attr("d",l),o.call(u.event),c},c.voronoi=function(){o.selectAll(".voronoi").remove();var e=t.map(function(e){return d3.merge([f(e.location.coordinates),[e.value]])}),n=d3.extent(e,function(e){return e[0]}),r=d3.extent(e,function(e){return e[1]}),i=d3.geom.voronoi().clipExtent([[n[0]-5,r[0]-5],[n[1]+5,r[1]+5]]),s=t.map(function(e){return+e.value});s=s.sort(d3.descending),range=d3.extent(s),console.log("range before",range),range=d3.extent(s.filter(function(e,t,n){return t>5&&t<n.length-5})),console.log("range after",range);var a=d3.scale.linear().domain([range[0]-500,range[0],range[1],range[1]+500]).range(["blue","yellow","red","green"]),l=o.append("g").selectAll("path.voronoi").data(i(e)).enter().append("path").attr("class","voronoi").style("fill",function(t,n){return a(e[n][2])}).attr("d",h).on("mouseover",function(r,i){var s=t[i],o=Object.getOwnPropertyNames(s);html=o.map(function(e){return e+": "+s[e]+"<br>"}),console.log("moused voronoi",e[i][2],s),d3.selectAll("path.voronoi").style("stroke",null),d3.select(this).style("stroke","black"),d3.select("#well-info").html(html.join(""))}).on("mouseout",function(n,r){console.log("moused out of voronoi",e[r][2])});o.selectAll("circle").data(e).enter().append("circle").attr("class","voronoi").style("fill",function(e,n){return a(t[n].value)}).style("stroke","black").attr("cx",function(e){return e[0]}).attr("cy",function(e){return e[1]}).attr("r",3).on("mouseover",function(n,r){console.log("moused circle",e[r][2])}),o.call(u.event)},c.size=function(t){return arguments.length?(e=t,c):e},c.data=function(e){return arguments.length?(t=e,c):t},c}