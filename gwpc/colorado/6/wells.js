d3.wells=function(){function o(s){function c(e,o,c,h){t=c;var p=o.objects.co,d=topojson.merge(o,p.geometries),v=Object.keys(h.objects).map(function(e){return topojson.feature(h,h.objects[e])}),m=path.bounds(d),g=.95/Math.max((m[1][0]-m[0][0])/n,(m[1][1]-m[0][1])/r),y=[(n-g*(m[1][0]+m[0][0]))/2,(r-g*(m[1][1]+m[0][1]))/2];projection.scale(g).translate(y);var b=i.append("g");b.append("path").datum(d).attr("class","state").attr("d",path),b.append("defs").append("clipPath").attr("id","state-clip").append("path").datum(d).attr("d",path),b.append("path").datum(topojson.mesh(o,p,function(e,t){return e!==t})).attr("class","county-border").attr("d",path),b.selectAll(".basin").data(v[0].features).enter().append("path").attr("class","basin").attr("clip-path","url(#state-clip)").attr("d",path).on("mouseover",u).on("mousemove",f).on("mouseout",l),b.selectAll(".play").data(v[1].features).enter().append("path").attr("class","play").classed("prospective",function(e){return e.properties.Current==="N"}).attr("clip-path","url(#state-clip)").attr("d",path).on("mouseover",a).on("mousemove",f).on("mouseout",l),s()}return arguments.length||(s=function(){console.log("Done initializing d3.wells")}),d3.select("#wells").node()!==null?o:(n=e[0],r=e[1],i=d3.select("body").append("svg").attr("width",n).attr("height",r),queue().defer(d3.json,"co.json").defer(d3.json,"file.json").defer(d3.json,"shalegasplay.json").await(c),o)}function u(e){s[0][0].innerHTML=e.properties.NAME+" Basin",s.style("visibility","visible"),s.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function a(e){var t=e.properties.Shale_Play+" Play";e.properties.Current==="Y"&&(t+=" (current)"),e.properties.Current==="N"&&(t+=" (prospective)"),s[0][0].innerHTML=t,s.style("visibility","visible"),s.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function f(e){s.style("top",d3.event.pageY-10+"px").style("left",d3.event.pageX+20+"px")}function l(e){s.style("visibility","hidden")}var e=[600,500],t,n,r,i,s=d3.select("body").append("div").attr("class","tooltip").style("visibility","hidden");return o.plotFormation=function(e,s){var u=e.replace(/\s/g,"_").toLowerCase()+"_"+s.toLowerCase(),a=t.filter(function(e){return e.hasOwnProperty(u)}),f=i.selectAll(".formationLabel").data([d3.format(",.0f")(a.length)+" wells"]);f.enter().append("text").attr("class","formationLabel").attr("x",.75*n).attr("y",.1*r).style("font-size","20px").text(String),f.text(String);var l=i.selectAll("path.circle").data(a.map(function(e){return e.location}));return l.exit().remove(),l.attr("d",path),l.enter().append("path").attr("class","circle").style("fill","steelblue").style("stroke","black").style("stroke-width",.5).attr("d",path),o},o.size=function(t){return arguments.length?(e=t,o):e},o.data=function(e){return arguments.length?(t=e,o):t},o}